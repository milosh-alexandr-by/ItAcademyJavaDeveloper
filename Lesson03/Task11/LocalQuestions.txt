1. Алгоритм не работает.
Но сам по себе он интересен.
Содержит много хороших внутренних алгоритмов.
Навести порядок и оставить для истории.

2. Решил задачу с помощью другого алгоритма. Смотри Tasl11_01.